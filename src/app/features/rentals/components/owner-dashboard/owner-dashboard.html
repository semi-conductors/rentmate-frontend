<!-- owner-dashboard.component.html -->
<div class="container">
  <!-- Header -->
  <div class="header">
    <div class="logo">Rent<span>Mate</span></div>
    <h1 class="page-title">ğŸ  Owner Dashboard</h1>
    <p class="page-subtitle">Manage all your rental items and track your income</p>
  </div>

  <!-- Stats Bar -->
  <div class="stats-bar">
    <div class="stat-card">
      <div class="icon">ğŸ“¦</div>
      <div class="label">Total Rentals</div>
      <div class="value">{{ totalRentals() }}</div>
    </div>
    <div class="stat-card revenue">
      <div class="icon">ğŸ’°</div>
      <div class="label">Total Revenue</div>
      <div class="value">${{ totalRevenue().toFixed(2) }}</div>
    </div>
  </div>

  <!-- Filter Tabs -->
  <div class="filter-tabs">
    <button 
      class="filter-tab" 
      [class.active]="selectedStatus() === null"
      (click)="filterByStatus(null)"
    >
      ğŸ“‹ All
      <span class="count">{{ totalRentals() }}</span>
    </button>
    <button 
      class="filter-tab" 
      [class.active]="selectedStatus() === 'Pending'"
      (click)="filterByStatus('Pending')"
    >
      â³ Pending
    </button>
    <button 
      class="filter-tab" 
      [class.active]="selectedStatus() === 'Approved'"
      (click)="filterByStatus('Approved')"
    >
      âœ… Approved
    </button>
    <button 
      class="filter-tab" 
      [class.active]="selectedStatus() === 'Completed'"
      (click)="filterByStatus('Completed')"
    >
      ğŸ‰ Completed
    </button>
    <button 
      class="filter-tab" 
      [class.active]="selectedStatus() === 'Rejected'"
      (click)="filterByStatus('Rejected')"
    >
      âŒ Rejected
    </button>
  </div>

  <!-- Loading State -->
  @if (isLoading()) {
    <div class="empty-state">
      <div class="icon">â³</div>
      <h3>Loading rentals...</h3>
    </div>
  }

  <!-- Empty State -->
  @if (rentals().length === 0 && !isLoading()) {
    <div class="empty-state">
      <div class="icon">ğŸ“­</div>
      <h3>No Rentals Found</h3>
      <p>You don't have any rentals for this filter.</p>
    </div>
  }

  <!-- Rentals List -->
  @if (!isLoading() && rentals().length > 0) {
    <div class="rentals-list">
      @for (rental of rentals(); track rental.rentalId) {
        <div 
          class="rental-item" 
          [class.expanded]="rental.isExpanded"
        >
          <div class="item-icon">{{ rental.itemIcon || 'ğŸ“¦' }}</div>
          <div class="rental-details">
            <div class="item-title">{{ rental.itemName || 'Loading...' }}</div>
            <div class="dates-info">
              ğŸ“… {{ formatDateShort(rental.startDate) }} â†’ {{ formatDateShort(rental.endDate) }} 
              ({{ rental.rentalDays }} days)
            </div>
          </div>
          <div class="rental-price">
            <div class="amount">${{ rental.totalPrice.toFixed(2) }}</div>
            <div class="label">Total</div>
          </div>
          <div class="rental-actions">
            <div 
              class="status-badge"
              [style.background-color]="getStatusColor(rental.status) + '20'"
              [style.border-color]="getStatusColor(rental.status)"
              [style.color]="getStatusColor(rental.status)"
            >
              {{ getStatusIcon(rental.status) }} {{ rental.status }}
            </div>
            <button class="btn-view" (click)="toggleDetails(rental.rentalId)">
              {{ rental.isExpanded ? 'Close' : 'View' }}
            </button>
          </div>

          <!-- Expanded Details -->
          @if (rental.isExpanded) {
            <div class="rental-expanded">
              <div class="details-grid">
                <div>
                  <div class="detail-section">
                    <h4>ğŸ“… Rental Period</h4>
                    <div class="detail-row">
                      <span class="detail-label">Start Date</span>
                      <span class="detail-value">{{ formatDate(rental.startDate) }}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">End Date</span>
                      <span class="detail-value">{{ formatDate(rental.endDate) }}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Duration</span>
                      <span class="detail-value highlight">{{ rental.rentalDays }} Days</span>
                    </div>
                  </div>

                  <div class="detail-section">
                    <h4>ğŸ“ Delivery Address</h4>
                    <div class="detail-row">
                      <span class="detail-value">{{ rental.renterAddress }}</span>
                    </div>
                  </div>
                </div>

                <div>
                  <div class="detail-section">
                    <h4>ğŸ’° Price Breakdown</h4>
                    <div class="detail-row">
                      <span class="detail-label">Daily Rate</span>
                      <span class="detail-value">${{ (rental.rentalPrice / rental.rentalDays!).toFixed(2) }}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Subtotal</span>
                      <span class="detail-value">${{ rental.rentalPrice.toFixed(2) }}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Deposit (15%)</span>
                      <span class="detail-value">${{ rental.depositAmount.toFixed(2) }}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Total</span>
                      <span class="detail-value highlight">${{ rental.totalPrice.toFixed(2) }}</span>
                    </div>
                  </div>

                  <div class="detail-section">
                    <h4>ğŸ“‹ Request Info</h4>
                    <div class="detail-row">
                      <span class="detail-label">Request Date</span>
                      <span class="detail-value">{{ formatDate(rental.createdDate) }}</span>
                    </div>
                    <div class="detail-row">
                      <span class="detail-label">Request ID</span>
                      <span class="detail-value">#{{ rental.rentalId }}</span>
                    </div>
                    @if (rental.status !== 'Pending') {
                      <div class="detail-row">
                        <span class="detail-label">Last Modified</span>
                        <span class="detail-value">{{ formatDate(rental.lastModifiedDate) }}</span>
                      </div>
                    }
                  </div>
                </div>
              </div>
              <button class="btn-close-details" (click)="toggleDetails(rental.rentalId)">
                Close Details
              </button>
            </div>
          }
        </div>
      }
    </div>

    <!-- Pagination -->
    <div class="pagination">
      <button 
        (click)="previousPage()" 
        [disabled]="currentPage() === 0"
      >
        â† Previous
      </button>
      <span class="page-info">
        Page <strong>{{ currentPage() + 1 }}</strong> of <strong>{{ totalPages() }}</strong>
      </span>
      <button 
        (click)="nextPage()" 
        [disabled]="currentPage() >= totalPages() - 1"
      >
        Next â†’
      </button>
    </div>
  }
</div>
