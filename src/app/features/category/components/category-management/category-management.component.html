<div class="category-management-container">
    <h1>Category Management</h1>

    <div class="add-category-form card">
        <h3>Add New Category</h3>
        <div class="input-group">
            <input 
                type="text" 
                placeholder="Category Name (e.g., Electronics)" 
                [ngModel]="newCategoryName()"
                (ngModelChange)="newCategoryName.set($event)"
                (keyup.enter)="addCategory()"
                class="form-input"
            />
            <button (click)="addCategory()" class="action-button primary-button">Add Category</button>
        </div>
    </div>
    
    @if (categoryState().error) {
        <p class="status-message error-message">{{ categoryState().error }}</p>
    }

    @if (categoryState().loading) {
        <p class="status-message loading-message">Loading categories...</p>
    }

    <div class="category-list-section card">
        <h3>Current Categories ({{ categoryState().categories.length }})</h3>

        @if (categoryState().categories.length === 0 && !categoryState().loading) {
            <p class="status-message no-data-message">No categories found.</p>
        }

        @if (categoryState().categories.length > 0) {
            <ul class="category-list">
            
                @for (category of categoryState().categories; track category.id) {
                    <li class="category-item">
                        
                        @if (editingCategory() && editingCategory()!.id === category.id) {
                            <div class="edit-mode">
                                <input 
                                    type="text" 
                                    [ngModel]="editingCategory()!.name"
                                    (input)="updateEditingName($event)"
                                    class="edit-input"
                                />
                                <div class="edit-actions">
                                    <button (click)="saveEdit()" class="action-button save-button">Save</button>
                                    <button (click)="cancelEdit()" class="action-button cancel-button">Cancel</button>
                                </div>
                            </div>
                        } @else {
                            <span class="category-name">{{ category.name }}</span>
                            <div class="item-actions">
                                <button (click)="startEdit(category)" class="action-button edit-button">Edit</button>
                                <button (click)="deleteCategory(category.id!)" class="action-button delete-button">Delete</button>
                            </div>
                        }
                    </li>
                }
            </ul>
        }
    </div>
</div>
