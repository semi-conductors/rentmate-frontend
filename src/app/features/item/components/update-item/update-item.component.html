<div class="update-item-container">
  <h1>Update Item</h1>
  <p class="subtitle">Update the details of your item below.</p>

  <div *ngIf="loading && !itemData" class="loading-message">Loading item details...</div>
  <div *ngIf="error" class="error-message">{{ error }}</div>

  <form *ngIf="itemData" (ngSubmit)="onSubmit()" #itemForm="ngForm">
    <div class="form-grid">
      
      <div class="form-group image-upload-group">
        <label>Item Image</label>
        <div class="current-image-preview" *ngIf="itemData.imageUrl && !selectedFileName">
          <img [src]="itemData.imageUrl" alt="Current Item Image">
          <span>Current Image</span>
        </div>
        <input type="file" (change)="onFileSelected($event)" id="imageUpload">
        <label for="imageUpload" class="upload-area">
          <span class="icon">üñºÔ∏è</span>
          <span>{{ selectedFileName || 'Upload new item image (optional)' }}</span>
        </label>
        <small class="note">Note: For image update, you must upload the file separately or rely on the backend setting the URL based on the PUT payload.</small>
      </div>

      <div class="form-group">
        <label for="title">Item Title</label>
        <input id="title" type="text" name="title" [(ngModel)]="itemData.title" required>
      </div>

      <div class="form-group">
        <label for="price">Price ($/day)</label>
        <input id="price" type="number" name="price" [(ngModel)]="itemData.price" required min="0.01" step="0.01">
      </div>

      <div class="form-group description-group full-width">
        <label for="description">Item Description</label>
        <textarea id="description" name="description" [(ngModel)]="itemData.description" rows="4" required></textarea>
      </div>

      <div class="form-group">
        <label for="category">Select category</label>
        <select id="category" name="categoryId" [(ngModel)]="itemData.categoryId" required>
          <option *ngFor="let cat of categories" [ngValue]="cat.id">{{ cat.name }}</option>
        </select>
      </div>

      <div class="form-group">
        <label for="availability">Availability</label>
        <select id="availability" name="availability" [(ngModel)]="itemData.availability" required>
          <option [ngValue]="true">Available</option>
          <option [ngValue]="false">Unavailable</option>
        </select>
      </div>

      <div class="form-group full-width">
        <label for="address">Owner Address</label>
        <input id="address" type="text" name="ownerAddress" [(ngModel)]="itemData.ownerAddress" required>
      </div>
    </div>
    
    <button type="submit" class="update-button" [disabled]="loading">
      {{ loading ? 'Updating...' : 'Update Item' }}
    </button>
  </form>
  
  <div *ngIf="errorMessage" class="server-error-message">{{ errorMessage }}</div>
</div>